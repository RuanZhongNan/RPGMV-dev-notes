# git

## 学习待办

https://www.zhihu.com/question/594294987/answer/3024615944

## 清空缓存

### way1

https://www.cnblogs.com/Renyi-Fan/p/13785622.html

git rm --cached "文件路径"，不删除物理文件，仅将该文件从缓存中删除；
git rm --f "文件路径"，不仅将该文件从缓存中删除，还会将物理文件删除（不会回收到垃圾桶）；

### way2

```bash
git clean -df
```

### way3

https://juejin.cn/post/7089249145252216862

git rm -r --cached .

## 快速更新远程分支

1. 清除旧分支

有时候需要让`VScode`或者是其他的`ide`显示最新的远程分支。如下图，下面有很多分支是过期的，如各种`bug`开头的分支。

![image-20220925204624533](https://raw.githubusercontent.com/RuanZhongNan/img-store/main/img/image-20220925204624533.png)v

2. 全量更新本地的旧分支和提交内容

比如说家用电脑进入到一个长期未更新的项目，就可以用该命令快速全量更新了。

### 具体做法

查找资料得知，需要使用命令行

```bash
git remote update origin --prune
```

如下图，删除了很多无用的旧分支：

![image-20220925204706126](https://raw.githubusercontent.com/RuanZhongNan/img-store/main/img/image-20220925204706126.png)

最终可用的远程分支全部更新为最新分支，如下图：

![image-20220925204724414](https://raw.githubusercontent.com/RuanZhongNan/img-store/main/img/image-20220925204724414.png)

### 参考资料

- [- 场景 1
  scode IDEA git 新建远程分支后看不到(新建分支更新)](https://blog.csdn.net/fyj13925475957/article/details/107415663)
- [vscode 无法获取切换 git 上最新的远程分支解决办法](https://blog.csdn.net/gxh0816/article/details/124659164)

### 其他相似内容

- [Visual Studio Git 分支本地缓存清理](https://blog.csdn.net/emirma/article/details/120777500)

## 删除远程分支

常用的删除远程分支命令：

```bash
git push origin -d your-branch-name
```

## 删除全部储存的内容

删除当前 git 全部储存的内容 准备重新提交一次。目前不清楚在哪里找到的此方案。

```bash
git rm -r --cached .
```

## 查看 git 本地配置

- 查看系统 config

```sh
git config --system --list
```

- 查看本机的全局配置

```sh
git config --global --list
```

设置本机的用户名
`git config --global user.name ruan-cat`

## 认证失败

参考资料 https://blog.csdn.net/weixin_44014995/article/details/109900149

```
> git pull --tags origin hope
> fatal: unable to access 'https://github.com/RuanZhongNan/RPGMV-dev-notes.git/': SSL certificate problem: unable to get local issuer certificate
```

## 用 rebase 代替 merge

阅读了一些文章。称最好用 git rebase 功能来做代码合并。用 rebase 变基功能代替单纯的分支合并。这个功能能更好的让 git 提交记录简洁清晰，呈现单线的提交记录。

良好清晰的 git 提交记录能够有效地记录开源项目的历史提交内容。

<!-- TODO: -->

尚不清楚 rebase 功能能否克服 svn 识别文件冗余的情况。仍需要自测一次。

## git 部分克隆

在此文章内看到该内容：
https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/README.zh-Hans.md#部分克隆

## 更改本机全局的默认主分支名称

现在希望本地新建的 git 仓库的默认主分支名称为 main，而不是之前常见的 master。主要是希望 rebase 变基分支时可以少输入一些字母。

用以下的系统级命令查看到要修改的 init.defaultBranch 配置。

```sh
git config --system --list
```

如下图所示，在 system 级下看到本机默认的 init.defaultBranch 配置，这里默认命名为 master 分支

![2023-05-08-09-46-25](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-05-08-09-46-25.png)

使用以下命令修改分支命名。

```sh
git config --global init.defaultBranch main
```

值得注意的是，这里修改的是 global 级全局配置，而不是 system 级的系统配置。

![2023-05-08-10-00-41](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-05-08-10-00-41.png)

### 本地测试

本地初始化 git 仓库，可以看到新创建的 git 仓库，其主分支的默认命名更改为 main 而不是 master。

![2023-05-08-10-05-02](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-05-08-10-05-02.png)

### 参考资料

- [快速设置 Git 默认分支名称 由 master 变为 main](https://juejin.cn/post/6942750082999517221)

## 重新命名远程分支

对远程分支的名称不爽，想改名。基本步骤如下：

```sh
git branch -m oldName newName
git push -d origin oldName
git push -u origin newName
```

上述命令的参考资料：

- [Git ：如何修改远程分支名称](https://blog.csdn.net/Lakers2015/article/details/129180899)

### 具体演示

这里仅仅演示重命名`非默认`的远程分支。如果是为了删除主分支（远程仓库认定的默认分支），则需要其他的步骤来完成删除以及重命名操作。

#### 初始化例子

这里打算重命名 dev 分支为 fuck-dev 分支。暂时不考虑主分支的重命名。

![2023-05-08-11-18-59](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-05-08-11-18-59.png)

#### 重命名本地分支

```sh
git branch -m dev fuck-dev
```

![2023-05-08-11-20-42](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-05-08-11-20-42.png)

#### 删除远程分支

```sh
git push -d origin dev
```

![2023-05-08-11-22-24](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-05-08-11-22-24.png)

#### 推送本地分支并关联远程分支

```sh
git push -u origin fuck-dev
```

![2023-05-08-11-23-42](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-05-08-11-23-42.png)

至此已完成重命名远程分支的需求。

### -u 是什么命令？

本地分支和远程分支关联的命令。

https://blog.csdn.net/Lakers2015/article/details/111318801

### receive.denyDeleteCurrent

删除分支时被拒绝。修改全局配置。

```sh
git config --global receive.denyDeleteCurrent warn
```

https://juejin.cn/post/6981733889664368677

### 重设远程默认分支

https://blog.csdn.net/wujj200884/article/details/84999006
