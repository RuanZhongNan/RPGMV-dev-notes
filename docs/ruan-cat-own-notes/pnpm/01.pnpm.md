# pnpm

## 管理全局依赖

先用 `pnpm i -g typescript ts-node` 安装全局依赖
再用 `pnpm ls -g` 查看全局依赖
最后 `pnpm up -g` 升级本机的全局依赖

## 安装后无法被识别到

```
PS E:\code\rzn\personal-proj\RPGMV-dev-notes> pnpm -v
pnpm : 无法将“pnpm”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次。
所在位置 行:1 字符: 1
+ pnpm -v
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (pnpm:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
```

参考资料 https://juejin.cn/post/7189174073899876409

## cmd 无权限

```
PS C:\Windows\system32> pnpm -v
pnpm : 无法加载文件 E:\dev-evn\node-store\node_global\pnpm.ps1，因为在此系统上禁止运行脚本。有关详细信息，请参阅 https:
/go.microsoft.com/fwlink/?LinkID=135170 中的 about_Execution_Policies。
所在位置 行:1 字符: 1
+ pnpm -v
+ ~~~~
    + CategoryInfo          : SecurityError: (:) []，PSSecurityException
    + FullyQualifiedErrorId : UnauthorizedAccess
```

参考资料 https://blog.csdn.net/weixin_46212682/article/details/121784020

## 在 vscode 终端内运行失败

- vscode 设置为管理员权限运行
  https://blog.csdn.net/qq_41701363/article/details/113992144

- 综合解决方案
  https://blog.csdn.net/weixin_41563986/article/details/121183842

## override.newPref.startsWith is not a function

如下图所示，这里的 pnpm 想要实现全局依赖管理，就要先切换到 node16。在 node14 下是找不到全局依赖的。

![2023-06-12-14-52-45](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-06-12-14-52-45.png)

## 值得注意的版本差

注意到在不同的 node 环境下，pnpm 有着不同的版本。

### node16

```bash
PS C:\Windows\system32> node -v
v16.19.0
PS C:\Windows\system32> pnpm -v
8.2.0
```

![2023-06-12-14-56-32](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-06-12-14-56-32.png)

### node14

```bash
PS C:\Windows\system32> node -v
v14.20.1
PS C:\Windows\system32> pnpm -v
7.22.0
```

![2023-06-12-14-58-19](https://cdn.jsdelivr.net/gh/RuanZhongNan/img-store/img/2023-06-12-14-58-19.png)

### 猜测

不知道是为什么，pnpm 作为全局包，在不同的 node 环境下，有着不同的版本。不知道是不是 nvm 本身的 node 导致全局包的存储全部混乱了。
